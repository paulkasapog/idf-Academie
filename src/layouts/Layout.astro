---
import '../styles/global.css';
import { SITE, CONTACT, LOCATION, ROUTES , SOCIAL, ASSETS } from "../data/config.ts";

// Props venant de la page
const {
  title = SITE.name,
  description = SITE.description,
  url = "/", // chemin relatif par défaut
  image = ASSETS.logo.src, // URL de l'image, pas l'objet complet
  robots = "index,follow",
} = Astro.props;

// Fonction pour rendre une URL absolue
const toAbs = (path: string) =>
  path.startsWith("http") ? path : new URL(path, SITE.url).href;

const pageUrl  = toAbs(url);
const imageUrl = toAbs(image);
const logoUrl  = toAbs(ASSETS.logo.src);
---
<html lang="fr" class="scroll-smooth">
  <head>
    <!-- Base -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={pageUrl} />
    <meta name="robots" content={robots} />
    

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={pageUrl} />
    <meta property="og:image" content={imageUrl} />
    <meta property="og:locale" content="fr_FR" />
    <meta property="og:site_name" content={SITE.name} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={imageUrl} />

    <!-- Favicons -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
    <!-- JSON-LD -->
    <script
      type="application/ld+json"
      set:html={JSON.stringify({
        "@context": "https://schema.org",
        "@type": "SportsOrganization",
        name: SITE.name,
        url: SITE.url,
        slogan: SITE.tagline,
        foundingDate: `${SITE.foundingYear}-01-01`,
        address: {
          "@type": "PostalAddress",
          addressLocality: LOCATION.city,
          addressCountry: "FR",
        },
        email: CONTACT.email,
        telephone: CONTACT.phone,
        areaServed: "Île-de-France",
        description: SITE.description,
        logo: logoUrl,   
        image: imageUrl, 
      })}
    ></script>
  </head>



  <body class="bg-neutral-950 text-white antialiased">
    <!-- Header / Nav -->
    <header class="sticky top-0 z-50 bg-neutral-950/80 backdrop-blur border-b border-neutral-800">
      <div class="mx-auto max-w-6xl px-4 h-16 flex items-center justify-between">
        <a href="/" class="flex items-center gap-3">
          <img src={ASSETS.logo.src} alt={ASSETS.logo.alt} class="h-10 w-10 object-contain" />
          <span class="font-semibold tracking-wide">{SITE.name}</span>
        </a>

        <!-- Desktop nav -->
        <nav class="hidden md:flex items-center gap-6 text-sm">
          <a class="nav" href="/">Accueil</a>
          <a class="nav" href={ROUTES.about}>À propos</a>
          <a class="nav" href={ROUTES.planning}>Planning</a>
          <a class="nav" href={ROUTES.galerie}>Galerie</a>
          <a class="btn" href={ROUTES.contact}>Contact</a>
        </nav>

        <!-- Mobile burger -->
        <button id="menuBtn" class="md:hidden inline-flex items-center justify-center rounded-xl h-10 w-10 border border-neutral-800">
          <span class="sr-only">Ouvrir le menu</span>
          ☰
        </button>
      </div>

      <!-- Mobile menu -->
      <div id="mobileMenu" class="md:hidden hidden border-t border-neutral-800">
        <nav class="px-4 py-3 flex flex-col gap-2">
          <a class="nav px-1 py-2" href="/">Accueil</a>
          <a class="nav px-1 py-2" href="/a-propos">À propos</a>
          <a class="nav px-1 py-2" href="/planning">Planning</a>
          <a class="nav px-1 py-2" href="/galerie">Galerie</a>
          <a class="btn w-full text-center" href="/contact">Contact</a>
        </nav>
      </div>
    </header>

    <main class="mx-auto max-w-6xl px-4 py-10">
      <slot />
    </main>

    <footer class="mt-10 border-t border-neutral-800">
      <div class="mx-auto max-w-6xl px-4 py-8 grid gap-6 md:grid-cols-3">
        <div>
          <div class="flex items-center gap-3">
            <img src={ASSETS.logo.src} alt={ASSETS.logo.alt} class="h-10 w-10" />
            <p class="font-semibold">{SITE.name} – Football Club</p>
          </div>
          <p class="mt-2 text-sm text-neutral-300">
            {LOCATION.city} , {LOCATION.mainVenue}
          </p>
        </div>
        <div>
          <p class="font-medium mb-2">Contacts</p>
          <p class="text-sm text-neutral-300">Email : {CONTACT.email}</p>
          <p class="text-sm text-neutral-300">Téléphone : {CONTACT.phone}</p>
        </div>
        <div>
          <p class="font-medium mb-2">Réseaux</p>
        <div class="flex gap-3">
          {SOCIAL.map((link) => (
            <a class="chip" href={link.href} target="_blank" rel="noopener">
              {link.label}
            </a>
          ))}
        </div>
        </div>
      </div>
      <div class="border-t border-neutral-800 text-center text-xs text-neutral-400 py-4">
        © {SITE.foundingYear} - {new Date().getFullYear()} {SITE.name}. Tous droits réservés.
      </div>
    </footer>

    <script>
      const btn = document.getElementById('menuBtn');
      const menu = document.getElementById('mobileMenu');
      btn?.addEventListener('click', () => menu?.classList.toggle('hidden'));
    </script>
  </body>
</html>
